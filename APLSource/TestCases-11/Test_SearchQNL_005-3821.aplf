 R←Test_SearchQNL_005(stopFlag batchFlag);n;n2;⎕TRAP;buffer;search
⍝ Search for "QAN" in #.TicToc with a ref pointing to a non-existing script.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')

 :If 1
    ⍝ This test case is not activce because we have not allowed the user (yet?!)
    ⍝ to un-tick the "Ugnore references" check box. The reason is that the user
    ⍝ is probably not interested in references ever.
     R←∆Inactive
     :Return
 :EndIf


 R←∆Failed

⍝ Preconditions
 #.TestData.⎕FIX ⎕SRC #.TestData.KeepCode.OptimaUtils
 #.TestData.TicToc.(OD6 Clock).O←#.TestData.OptimaUtils
 #.TestData.⎕EX'OptimaUtils'  ⍝ Delete object but leave the ref - this is an anomaly

 1 #._Fire.Fire.Run 0
 n←#._Fire.Fire.GUI.n

 n.SearchFor.Text←'QAN'
 n.LookIn.Text←'#.TestData.TicToc'
 n.IgnoreRefs.State←0
 ⎕NQ n.Tab2'Select'
 ∆Process n.Form
 n.Case2.State←1
 n.Vars2.State←0

 {}∆Select n.StartBtn
 0.2 ∆Process n.Form
 →GoToTidyUp 4≠#._Fire.Fire.G.NoOfObjects
 →GoToTidyUp'#.TestData.OptimaUtils'≢0⊃n.HitList.ReportInfo[3;]
 R←∆OK

∆TidyUp:
 #.TestData.TicToc.⎕EX'O'
 CloseFire
