 R←Test_Replace_303(stopFlag batchFlag);n;n2;⎕TRAP;rf;code
 ⍝ Find and delete lines. This test focuses on deleting objects in "empty" scripts
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←∆Failed

⍝ Preconditions
 #.⎕SHADOW'TEMP'
 'TEMP'#.⎕NS''
 code←⊂':Class Foo2 ⍝ ∆∆∆'                      ⍝ Despite comments being part of the search, the first and last line of a script is never deleted!
 code,←⊂':EndClass  ⍝ ∆∆∆'                      ⍝ Despite comments being part of the search, the first and last line of a script is never deleted!
 #.TEMP.⎕FIX code,¨code
 code←⊂':Namespace NS2 ⍝ ∆∆∆'                   ⍝ Despite comments being part of the search, the first and last line of a script is never deleted!
 code,←⊂':EndNamespace ⍝ ∆∆∆'                   ⍝ Despite comments being part of the search, the first and last line of a script is never deleted!
 #.TEMP.⎕FIX code,¨code

 1 #._Fire.Fire.Run 0
 n←#._Fire.Fire.GUI.n

 n.SearchFor.Text←'∆∆∆'
 n.LookIn.Text←'#.TEMP'

 {}∆Select n.StartBtn
 ∆Process n.Form
 →GoToTidyUp 2≠#._Fire.Fire.G.NoOfObjects ⍝ Since version 3.5 the scripts as such DO count!

 {}∆Select n.ReplaceBtn
 ∆Process n.Form

 n2←#._Fire.Fire.Replace.n
 n2.ReplaceBy.Text←''
 n2.DeleteLine.State←1
 n2.MarkChanges.(Active State)←1 0
 n2.MarkChangesText.Text←''
 n2.MarkChangesText.(Active BCol)←1 0
 n2.MarkChangesType.Active←1
 n2.MarkChangesType.SelItems←0 1 0

 {}∆Select n2.StartBtn
 ∆Process n2.Form
 →PassesIf 2=⍴#.TEMP.⎕SRC #.TEMP.Foo2
 →PassesIf 2=⍴#.TEMP.⎕SRC #.TEMP.NS2
 R←∆OK

∆TidyUp:
 CloseFire
