 R←Test_SearchQNL_006(stopFlag batchFlag);n;n2;⎕TRAP;buffer;search
⍝ Search for "QAN" in #.TicToc with "Ignore refs" switched off.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

⍝ Preconditions
 #.TestData.⎕FIX ⎕SRC #.TestData.KeepCode.OptimaUtils
 #.TestData.TicToc.(OD6 Clock).O←#.TestData.OptimaUtils

 1 #.Fire.Fire.Run 0
 n←#.Fire.Fire.GUI.n

 n.SearchFor.Text←'QAN'
 n.LookIn.Text←'#.TestData.TicToc'
 n.IgnoreRefs2.State←1
 ⎕NQ n.Tab2'Select'
 ∆Process n.Form
 n.Case2.State←1
 n.Vars2.State←0

 {}∆Select n.StartBtn
 0.2 ∆Process n.Form
 →T.GoToTidyUp 3≠#.Fire.Fire.G.NoOfObjects
 →T.GoToTidyUp(⊂'#.TestData.OptimaUtils')∊n.HitList.ReportInfo[;0]
 R←T._OK

∆TidyUp:
 #.TestData.TicToc.⎕EX'O'
 CloseFire
